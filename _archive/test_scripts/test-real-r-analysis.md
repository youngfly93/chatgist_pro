# 如何触发真正的R分析

## 正确的触发词示例

以下是会真正执行R脚本的请求方式：

1. **查询磷酸化位点**
   - "查询KIT基因的磷酸化位点"
   - "KIT基因有哪些磷酸化位点"

2. **肿瘤vs正常分析**
   - "分析KIT基因在肿瘤和正常组织中的磷酸化差异"
   - "显示PDGFRA基因肿瘤vs正常的磷酸化水平"

3. **风险分析**
   - "KIT基因磷酸化与风险等级的关系"
   - "分析PDGFRA磷酸化在高低风险组的差异"

4. **生存分析**
   - "KIT基因磷酸化的生存分析"
   - "PDGFRA磷酸化水平与患者生存期的关系"

## 如何验证是否执行了R脚本

1. **检查网络请求**
   - 打开浏览器开发者工具（F12）
   - 进入Network标签
   - 发送分析请求
   - 查看/api/chat响应是否包含`phosphoAnalysis`字段

2. **查看响应结构**
   真正的R分析响应包含：
   ```json
   {
     "reply": "AI的文字回复...",
     "phosphoAnalysis": {
       "status": "success",
       "plot": "data:image/png;base64,iVBORw0KG...",  // 很长的base64字符串
       "data": {
         "gene": "KIT",
         "analysis_type": "query",
         "results": [...]
       }
     }
   }
   ```

3. **界面表现**
   - 会显示实际的图表（而不是文字描述）
   - 有"查看详细数据"的折叠项
   - 加载时间较长（因为需要执行R脚本）

## 测试建议

1. **关闭流式输出**（流式模式不支持R分析）
2. 使用上面的触发词发送请求
3. 观察是否有图表显示
4. 检查后端控制台日志

如果仍然没有执行R脚本，可能是：
- 后端服务未正确启动
- R环境未配置
- phospho_api.R文件不存在